<!DOCTYPE html><html lang=en-GB><html lang=en-GB><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><title>Introducing RALTS (Really Awesome Lexicon and Tag Suggester)</title><link href=/style/style.css rel=stylesheet><link href=/fonts/DMSerifDisplay-Regular-subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/NyghtSerif-Light-subset.woff2 rel=preload type=font/woff2 as=font crossorigin><script async src=https://plausible.io/js/pa-juzxS8GCoNHZxPt1EMkES.js></script><script type=module>document.querySelectorAll(".nav-links a").forEach((e=>{e.href===window.location.href&&e.setAttribute("aria-current","page")}))</script><link href=/favicon.svg rel=icon type=image/svg+xml><link href=/favicon.png rel=icon type=image/png><meta content="index, follow" name=robots><meta content="Introducing RALTS (Really Awesome Lexicon and Tag Suggester)" name=title><meta content="I love NLP and taxonomies. Here's a script I wrote that marries the two concepts." name=description><meta content=https://lukealexdavis.co.uk/images/ld-logo-og-image.jpg property=og:image><meta content="Astro v5.16.9" name=generator><meta content="Free Palestine, Black Lives Matter, and Trans Lives Matter" name=values><link href=https://lukealexdavis.co.uk/posts/introducing-ralts/ rel=canonical><link href=https://lukealexdavis.co.uk/blog.xml rel=alternate type=application/rss+xml title="Luke Alex Davis"><link href=https://uk.linkedin.com/in/lukealexdavis rel=me><link href=https://bsky.app/profile/lukealexdavis.co.uk rel=me><link href=https://github.com/starchildluke rel=me><link href=https://indieauth.com/auth rel=authorization_endpoint><script type=module>window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}},plausible.init()</script><style>aside[data-astro-cid-bvzihdzo]{display:inline;float:right;position:relative;width:20vw;margin-right:-25vw;font-size:8pt}@media(max-width:768px){aside[data-astro-cid-bvzihdzo]{display:block;float:none;margin:5% 10%;width:80%;font-size:.8rem}}.filed-under[data-astro-cid-4diiyzd3]{font-variant-caps:all-small-caps;margin-bottom:1.4rem;width:fit-content}.filed-under__intro[data-astro-cid-4diiyzd3]{font-weight:700;color:var(--grey-nice)}footer[data-astro-cid-sz7xmlte]{margin-top:var(--space-xl);display:flex;justify-content:space-between;gap:5rem;background:#181818;color:#f7f7f7}@media only screen and (max-width:480px){footer[data-astro-cid-sz7xmlte]{flex-direction:column}footer[data-astro-cid-sz7xmlte] [data-astro-cid-sz7xmlte]{text-align:center}}.colophon[data-astro-cid-sz7xmlte] ul[data-astro-cid-sz7xmlte],.footer-nav-links[data-astro-cid-sz7xmlte] ul[data-astro-cid-sz7xmlte]{display:flex;flex-direction:column;list-style:none;padding:0 0 1rem}.footer-nav-links[data-astro-cid-sz7xmlte] li[data-astro-cid-sz7xmlte]{font-size:inherit}.footer-nav-links[data-astro-cid-sz7xmlte]{text-align:left}.colophon[data-astro-cid-sz7xmlte]{text-align:right}.colophon[data-astro-cid-sz7xmlte] ul[data-astro-cid-sz7xmlte]{margin-bottom:0}.footer-url[data-astro-cid-sz7xmlte]{font-weight:700}a[data-astro-cid-sz7xmlte]{color:#c4e53c}.wmr[data-astro-cid-sz7xmlte]{color:#2da5d8}.wmr[data-astro-cid-sz7xmlte]:hover{color:#fa8c8c}</style></head></html><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://lukealexdavis.co.uk/#website","url":"https://lukealexdavis.co.uk/","name":"Luke Davis","publisher":{"@id":"https://lukealexdavis.co.uk/#Person"},"inLanguage":"en-GB"},{"@type":"Article","headline":"Introducing RALTS (Really Awesome Lexicon and Tag Suggester)","datePublished":"2022-02-28T00:00:00.000Z","author":{"@type":"Person","name":"Luke Davis","@id":"https://lukealexdavis.co.uk/","url":"https://lukealexdavis.co.uk/"},"publisher":{"@id":"https://lukealexdavis.co.uk/#Person","@type":"Person","name":"Luke Davis"},"name":"Introducing RALTS (Really Awesome Lexicon and Tag Suggester)","@id":"https://lukealexdavis.co.uk/posts/introducing-ralts/#richSnippet","inLanguage":"en-GB","mainEntityOfPage":{"@id":"https://lukealexdavis.co.uk/posts/introducing-ralts/#webpage"}},{"@type":"Person","image":["https://lukealexdavis.co.uk/images/k5t2wVcf-Luke-Davis-640x600.png","https://lukealexdavis.co.uk/images/lukedavis_jpg.jpg"],"url":"https://lukealexdavis.co.uk/","sameAs":["https://uk.linkedin.com/in/lukealexdavis","https://bsky.app/profile/lukealexdavis.co.uk","https://www.searchenginejournal.com/author/luke-davis/","https://www.semrush.com/user/147747585/","https://lukealexdavis.contently.com/","https://www.imdb.com/name/nm14089488/"],"alternateName":["Luke Davis","Luke Alex Davis","starchildluke"],"name":"Luke Davis","jobTitle":"Technical SEO","gender":"Male"}]}</script><body><header class=center id=top><div class=h1__block><h2 class=h2__home>Luke Davis</h2><svg height=25px viewBox="0 0 54 54" width=25px xmlns=http://www.w3.org/2000/svg class=logo version=1.2><title>LD wordmark logo</title><desc>A red rounded hexagon with the initials 'ld.' in lower case in the middle.</desc><style>.s0{fill:#fc1420;stroke:#fc1420;stroke-miterlimit:10}.s1{fill:#ffffff}</style><path d="m49.1 39.9c2.3 1.3-22.1 15.6-22.1 12.9 0 2.7-24.4-11.6-22.1-12.9-2.3 1.3-2.3-27.1 0-25.8-2.3-1.3 22.1-15.6 22.1-12.9 0-2.7 24.4 11.6 22.1 12.9 2.3-1.3 2.3 27.1 0 25.8z" class=s0 id=Layer></path><path d="m18.1 35c-0.2 0.6-0.2-17.2 0-16.7-0.2-0.5 3-3.1 2.9-2.5 0.1-0.6 0.1 17.8 0 17.4 0.1 0.4 2.2 1.7 2.1 1.8 0.2 1.1-2.3 2.7-2.4 2.1 0.1 0.6-2.8-1.5-2.6-2.1z" class=s1 id=Layer></path><path d="m24.7 34.1c-0.2 0.4-0.2-7.5 0-7.5-0.2 0 2.9-2.7 3-2.5-0.1-0.2-3.5-3.1-3.5-2.9-0.1-0.5 2.4-2.6 2.5-2-0.1-0.6 6.6 5.2 6.4 5.4 0.2-0.2 0.2 8.8 0 8.5 0.2 0.3-4.8 4.6-4.8 4 0 0.6-3.8-2.6-3.6-3zm-0.5-12.9q0 0 0.1 0.1-0.1-0.1-0.1-0.1zm8.9 3.4q0 0 0 0 0 0 0 0zm-3 1.6q0 0 0 0 0 0 0 0zm-2.4-2c-0.1-0.4-0.1 8.6 0 8.4-0.1 0.2 2.5 2.3 2.4 2 0.1 0.3 0.1-8.6 0-8.4 0.1-0.2-2.5-2.4-2.4-2z" class=s1 id=Layer fill-rule=evenodd></path><path d="m37 32.6c0-0.2 2.9 2.2 2.7 2.3 0.2-0.1-2.7 2.5-2.7 2.4 0 0.1-3-2.3-2.8-2.3-0.2 0 2.8-2.6 2.8-2.4z" class=s1 id=Layer></path></svg></div><nav class=nav-bar aria-label="site navigation"><ul class="center nav-links" role=list><li><a href=/ >home</a></li><li><a href=/about/ >about</a></li><li><a href=/posts/ >posts</a></li><li><a href=/morsels/ >morsels</a></li><li><a href=/jardim/ >jardim</a></li><li><a href=/uses/ >uses</a></li><li><a href=/misc/ >misc</a></li><li><a href=/support/ >support</a></li></ul></nav></header><main class=layout><article class=content><div><div class=post-meta><p class=publish-date><time datetime=2022-02-28T00:00:00.000Z>28 Feb 2022</time></p><h1>Introducing RALTS (Really Awesome Lexicon and Tag Suggester)</h1></div><p>I’ve been learning Python since October 2019 and exploring NLP since the end of last year and they’ve changed my life for the better. As I learn by doing, I’ve decided to show off arguably my greatest creation to do date. I wasn’t sure whether to do it as it’s very niche to me but I’ve taken a step out of my comfort zone.</p><p><a href=https://github.com/starchildluke/ralts>GitHub link to RALTS repository</a></p><h2 id=table-of-contents>Table of contents</h2><ol><li><a href=#ralts>What is RALTS?</a></li><li><a href=#why_did_you_make_this>Why did I make it?</a></li><li><a href=#notes_on_my_coding>Notes on my coding</a></li><li><a href=#some_definitions>Some definitions</a></li><li><a href=#tech_requirements>Tech requirements</a></li><li><a href=#the_code>The code</a></li><li><a href=#who_could_this_benefit>Who could this benefit?</a></li><li><a href=#evaluation>Evaluation</a></li><li><a href=#summary>Summary</a></li></ol><h2 id=ralts>What is RALTS?</h2><p>RALTS stands for (Really Awesome Lexicon and Tag Suggester) and it’s a script that extracts entities, topics, and categories from a body of text using the TextRazor API. But what it also does is use NLP classification to analyse that text based on labels pulled from the extracted topics. Confused? I’ll explain those all in more detail later.</p><p>There is also a secondary function that has nothing to do with suggesting tags but I’ll explain it here. I have also set up functionality that pulls all my tags from my blogs and randomly joins them together in a Google search query for content ideas. They are inversely weighted so the least used tags appear more frequently in the randomised search queries.</p><p>Examples:</p><ul><li><a href="https://google.com/search?q=vhs+black+cinema">https://google.com/search?q=vhs+black+cinema</a></li><li><a href="https://google.com/search?q=cuba+snow">https://google.com/search?q=cuba+snow</a></li><li><a href="https://google.com/search?q=nike+poetry">https://google.com/search?q=nike+poetry</a></li><li><a href="https://google.com/search?q=night+keith+haring">https://google.com/search?q=night+keith+haring</a></li><li><a href="https://google.com/search?q=australia+dogs">https://google.com/search?q=australia+dogs</a></li></ul><p>In terms of the name, I chose RALTS because all the Sesame Street references were taken and I’m a Pokémon fan. It’s a backronym but it works for me.</p><h2 id=why_did_you_make_this>Why did I make it?</h2><p>tl;dr: it aids my blogging process.</p><p>I love anything to do with taxonomies, ontologies, and classification. I’m a tagger and a labeler. There are limits to what and how I label in a social and metaphysical sense but for my blogs, I love the process. It helps my information retrieval and it ties so well into SEO (which is my profession in case you missed it).</p><p>Fundamentally, I wanted a script to tell me what tags to use for my blogs if I couldn’t think of any or had retrospectively missed anything. By extracting entities and topics, I can cross reference it with existing tags or spot any new ones that make sense or keep cropping up.</p><h2 id=notes_on_my_coding>Notes on my coding</h2><p>Before I dive into the code, I want to make something clear: I’ve only been coding in Python for just under 2.5 years. I’ve done all of this in my own time with no formal training and following a Udemy course I still haven’t finished. You’ll likely see some inefficient or unpythonic code. If you do, feel free to shout up as that will help me improve. But please: only constructive feedback. There are way too many videos online calling people out for “stupid code” and I find it demeaning and gatekeep-y (technical term).</p><p>I also want to give credit to Joe Davison whose data plot code I used from his zero shot demo. He wrote a great piece on <a href=https://joeddav.github.io/blog/2020/05/29/ZSL.html>zero shot learning</a> which you should read if you’re interested.</p><p><a href=https://huggingface.co/spaces/joeddav/zero-shot-demo>There’s also a live zero shot classification demo you can try that shows the code I copied in action</a>.</p><p>If I’ve taken anything that belongs to anyone whom I’ve forgotten to credit or if you’d prefer I remove it, please let me know and accept my sincerest apologies.</p><h2 id=some_definitions>Some definitions</h2><p>So, about that original explanation. Let’s look at some definitions:</p><ul><li><p>Entities - Real-world objects, such as people, organisations, locations, products, that can be denoted with a proper name. They can be abstract or have a physical existence. Examples of named entities include: Python, London, David Beckham, Nelson Mandela, Manchester United, The Simpsons, cooking.</p></li><li><p>Topics - These are broader terms that can describe wider ranges of ideas. Examples of topics include: American sitcoms, British footballers, programming languages, capital cities, world leaders, television series. Sometimes an entity can be a topic. In the specific context of the Text Razor API, a topic is more specific than a category and TextRazor has “an automatic understanding of hundreds of thousands of different topics at different levels of abstraction”.</p></li><li><p>Categories - The term “categories” is sometimes used interchangably with topics but in this context, a category is a broader term with which an entity and/or topic can fall under. Examples of categories include: arts, culture and entertainment > animation; health > hospital and clinic; economy, business and finance > media > advertising</p></li><li><p>Text classification - the task of assigning a document or text to one or more classes, categories, or labels. In NLP, this can be done manually or programmatically. The aim of the script is to do this with the help of the extracted topics and a machine learning language model.</p></li><li><p>Labels - Forms of annotation that classify what a text is about. They’re basically like tags.</p></li></ul><h2 id=tech_requirements>Tech requirements</h2><p>These are the following Python packages used in the script:</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>streamlit>=1.0.0</span></span>
<span class=line><span>pandas>=1.2.3</span></span>
<span class=line><span>transformers>=4.12.3</span></span>
<span class=line><span>requests>=2.25.1</span></span>
<span class=line><span>bs4>=0.0.1</span></span>
<span class=line><span>plotly>=5.4.0</span></span>
<span class=line><span>numpy>=1.18.0</span></span>
<span class=line><span>textrazor==1.4.0</span></span>
<span class=line><span>tensorflow>=2.7.0</span></span></code></pre><p><a href=https://streamlit.io/ >Streamlit</a> for the UI, <a href=https://pandas.pydata.org/ >pandas</a> for data manipulation, <a href=https://huggingface.co/docs/transformers/main_classes/pipelines>Transformers</a> for the language model, requests and <a href=https://www.crummy.com/software/BeautifulSoup/bs4/doc/ >BeautifulSoup</a> for web scraping, <a href=https://plotly.com/ >plotly</a> and <a href=https://numpy.org/ >NumPy</a> for data viz, <a href=https://www.textrazor.com/ >TextRazor</a> for the entities and such, and <a href=https://www.tensorflow.org/ >TensorFlow</a> for the language model.</p><p>Regarding TensorFlow, the language model I’m using is called <a href=https://huggingface.co/valhalla/distilbart-mnli-12-9>DistilBart-MNLI</a> and instructions can be found on the Hugging Face link about how to download, fine-tune, deploy, and use in Transformers via Python.</p><h2 id=the_code>The code</h2><p>The code is split into different parts:</p><h3 id=1-textrazor-api-key-and-client-details>1. TextRazor API key and client details</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># TextRazor details</span></span>
<span class=line><span style=color:#e1e4e8>textrazor.api_key </span><span style=color:#f97583>=</span><span style=color:#79b8ff> API_KEY</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>client </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> textrazor.TextRazor(</span><span style=color:#ffab70>extractors</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>[</span><span style=color:#9ecbff>"entities"</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>"topics"</span><span style=color:#e1e4e8>])</span></span>
<span class=line><span style=color:#e1e4e8>client.set_classifiers([</span><span style=color:#9ecbff>"textrazor_newscodes"</span><span style=color:#e1e4e8>])</span></span></code></pre><p>We set the API key (which you can generate with a free account on the TextRazor website) and tell the client to use the entities and topics extractors. We also set the classifiers to <code>textrazor_newscodes</code>. <a href=https://www.textrazor.com/classification>Find out more on TextRazor’s Classification page</a>.</p><h3 id=2-function-for-loading-the-language-model-via-a-pipeline-using-zero-shot-classification-the-classification-process-plotting-the-results-and-web-scraping>2. Function for loading the language model via a pipeline using zero shot classification, the classification process, plotting the results, and web scraping</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Load model</span></span>
<span class=line><span style=color:#b392f0>@st.cache</span><span style=color:#e1e4e8>(</span><span style=color:#ffab70>allow_output_mutation</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> load_model</span><span style=color:#e1e4e8>():</span></span>
<span class=line><span style=color:#f97583>  return</span><span style=color:#e1e4e8> pipeline(</span><span style=color:#9ecbff>"zero-shot-classification"</span><span style=color:#e1e4e8>, </span></span>
<span class=line><span style=color:#ffab70>  model</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'valhalla/distilbart-mnli-12-9'</span><span style=color:#e1e4e8>, </span></span>
<span class=line><span style=color:#ffab70>  multi_label</span><span style=color:#f97583>=</span><span style=color:#79b8ff>True</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Classification function</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> classify</span><span style=color:#e1e4e8>(sequences, candidate_labels):</span></span>
<span class=line><span style=color:#e1e4e8>  output_results </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> load_model()(</span><span style=color:#ffab70>sequences</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>sequences,</span></span>
<span class=line><span style=color:#ffab70>    candidate_labels</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>candidate_labels)</span></span>
<span class=line><span style=color:#f97583>  return</span><span style=color:#e1e4e8> output_results[</span><span style=color:#9ecbff>'labels'</span><span style=color:#e1e4e8>], output_results[</span><span style=color:#9ecbff>'scores'</span><span style=color:#e1e4e8>]</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Graph plot function</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> plot_result</span><span style=color:#e1e4e8>(top_topics, scores):</span></span>
<span class=line><span style=color:#e1e4e8>  top_topics </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> np.array(top_topics)</span></span>
<span class=line><span style=color:#e1e4e8>  scores </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> np.array(scores)</span></span>
<span class=line><span style=color:#e1e4e8>  scores </span><span style=color:#f97583>*=</span><span style=color:#79b8ff> 100</span></span>
<span class=line><span style=color:#e1e4e8>  fig </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> px.bar(</span><span style=color:#ffab70>x</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>scores, </span></span>
<span class=line><span style=color:#ffab70>    y</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>top_topics,</span></span>
<span class=line><span style=color:#ffab70>    orientation</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'h'</span><span style=color:#e1e4e8>, </span></span>
<span class=line><span style=color:#ffab70>    labels</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>{</span><span style=color:#9ecbff>'x'</span><span style=color:#e1e4e8>: </span><span style=color:#9ecbff>'Confidence'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'y'</span><span style=color:#e1e4e8>: </span><span style=color:#9ecbff>'Label'</span><span style=color:#e1e4e8>},</span></span>
<span class=line><span style=color:#ffab70>    text</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>scores,</span></span>
<span class=line><span style=color:#ffab70>    range_x</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>,</span><span style=color:#79b8ff>115</span><span style=color:#e1e4e8>),</span></span>
<span class=line><span style=color:#ffab70>    title</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'Top Predictions'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#ffab70>    color</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>np.linspace(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>,</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>,</span><span style=color:#79b8ff>len</span><span style=color:#e1e4e8>(scores)),</span></span>
<span class=line><span style=color:#ffab70>    color_continuous_scale</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'GnBu'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>  fig.update(</span><span style=color:#ffab70>layout_coloraxis_showscale</span><span style=color:#f97583>=</span><span style=color:#79b8ff>False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>  fig.update_traces(</span><span style=color:#ffab70>texttemplate</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'%</span><span style=color:#79b8ff>{text</span><span style=color:#f97583>:0.1f</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>%'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#ffab70>  textposition</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'outside'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>  st.plotly_chart(fig)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> req</span><span style=color:#e1e4e8>(url):</span></span>
<span class=line><span style=color:#e1e4e8>  resp </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> requests.get(url)</span></span>
<span class=line><span style=color:#e1e4e8>  soup </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> BeautifulSoup(resp.content, </span><span style=color:#9ecbff>'html.parser'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>  if</span><span style=color:#e1e4e8> soup.find(</span><span style=color:#9ecbff>"div"</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>id</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"comments"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> soup.find(</span><span style=color:#9ecbff>"div"</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>id</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"secondary"</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#e1e4e8>    remove_comments </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> soup.find(</span><span style=color:#9ecbff>"div"</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>id</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"comments"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>    remove_comments.extract()</span></span>
<span class=line><span style=color:#e1e4e8>    remove_secondary </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> soup.find(</span><span style=color:#9ecbff>"div"</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>id</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"secondary"</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>    remove_secondary.extract()</span></span>
<span class=line><span style=color:#e1e4e8>    ext_t </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [t.text </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> t </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> soup.find_all([</span><span style=color:#9ecbff>'h1'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'p'</span><span style=color:#e1e4e8>])]</span></span>
<span class=line><span style=color:#e1e4e8>    paragraphs </span><span style=color:#f97583>=</span><span style=color:#9ecbff> ' '</span><span style=color:#e1e4e8>.join(ext_t)</span></span>
<span class=line><span style=color:#f97583>    return</span><span style=color:#e1e4e8> paragraphs</span></span>
<span class=line><span style=color:#f97583>  else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>    ext_t </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [t.text </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> t </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> soup.find_all([</span><span style=color:#9ecbff>'h1'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'p'</span><span style=color:#e1e4e8>])]</span></span>
<span class=line><span style=color:#e1e4e8>    paragraphs </span><span style=color:#f97583>=</span><span style=color:#9ecbff> ' '</span><span style=color:#e1e4e8>.join(ext_t)</span></span>
<span class=line><span style=color:#f97583>    return</span><span style=color:#e1e4e8> paragraphs</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Main function</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> main</span><span style=color:#e1e4e8>():</span></span>
<span class=line><span style=color:#f97583>  with</span><span style=color:#e1e4e8> st.spinner(</span><span style=color:#9ecbff>'Classifying...'</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>    global</span><span style=color:#e1e4e8> txt</span></span>
<span class=line><span style=color:#e1e4e8>    df_classify_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(topics_dict)</span></span>
<span class=line><span style=color:#e1e4e8>    df_classify_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_classify_topic.sort_values(</span></span>
<span class=line><span style=color:#ffab70>      by</span><span style=color:#f97583>=</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>, </span><span style=color:#ffab70>ascending</span><span style=color:#f97583>=</span><span style=color:#79b8ff>False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>    classify_topic_score </span><span style=color:#f97583>=</span><span style=color:#79b8ff> list</span><span style=color:#e1e4e8>(</span></span>
<span class=line><span style=color:#e1e4e8>      df_classify_topic[</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>][:</span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>])</span></span>
<span class=line><span style=color:#f97583>    if</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Text'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>      top_topics, scores </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> classify(</span></span>
<span class=line><span style=color:#e1e4e8>        txt, classify_topic_score)</span></span>
<span class=line><span style=color:#f97583>    elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'URL'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>      txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> req(url)</span></span>
<span class=line><span style=color:#e1e4e8>      top_topics, scores </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> classify(</span></span>
<span class=line><span style=color:#e1e4e8>        txt, classify_topic_score)</span></span>
<span class=line><span style=color:#f97583>    elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Multiple URLs'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>      txt </span><span style=color:#f97583>=</span><span style=color:#9ecbff> ' '</span><span style=color:#e1e4e8>.join(all_txt)</span></span>
<span class=line><span style=color:#e1e4e8>      top_topics, scores </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> classify(</span></span>
<span class=line><span style=color:#e1e4e8>        txt, classify_topic_score)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>  plot_result(top_topics[::</span><span style=color:#f97583>-</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>][</span><span style=color:#f97583>-</span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>:], scores[::</span><span style=color:#f97583>-</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>][</span><span style=color:#f97583>-</span><span style=color:#79b8ff>10</span><span style=color:#e1e4e8>:])</span></span></code></pre><p>There’s a lot here so I’ll break it down further.</p><p>The first function loads the distilbart model for this task and uses zero-shot classification to determine classification. I have also set a cache so it doesn’t reload every time, which saves loading time and CPU/GPU resources.</p><p>The second function is for the actual classification. It loads the model, and generates output results containing the labels and the relevance scores for each. Which labels we use are determined later.</p><p>The third function plots a horizontal bar chart of the top 10 labels alongside their scores. This allows us to visualise the best classification labels of the analysed text.</p><p>Here’s how the model classified this blog post:</p><p><img alt="A graph showing 10 labels the language model thinks my blog post is about. For example, the number 1 label is Blog with a 90% score" src=/images/classification-labels.jpg></p><p>The fourth function is the URL scraper. It takes a URL, extracts the HTML, ignores any comments sections or text found in sidebars (<a href=https://twitter.com/jessthebp/status/1496153327779950604>thanks to Jess for the help with that</a>) and finally filters the remaining text down to just the H1 title and text found in p tags, ready for analysis.</p><p>The fifth and final function brings everything together. It creates dataframes out of the found entities and topics and orders them by relevance score for ease.</p><h3 id=3-dictionaries>3. Dictionaries</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#e1e4e8>kw_dict </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'Keyword'</span><span style=color:#e1e4e8>: []</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>ent_dict </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'Keyword'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Relevance Score'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Existing Tag'</span><span style=color:#e1e4e8>: []</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>topics_dict </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'Topic'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Relevance Score'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Existing Tag'</span><span style=color:#e1e4e8>: []</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>categories_dict </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'Category'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Relevance Score'</span><span style=color:#e1e4e8>: []</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>tags </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'Tag'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'ID'</span><span style=color:#e1e4e8>: [],</span></span>
<span class=line><span style=color:#9ecbff>  'Count'</span><span style=color:#e1e4e8>: []</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span></code></pre><p>Arguably the easiest part, just setting the dictionaries for our entity outputs as well as the tags for the additional part of our script which is up next.</p><h3 id=4-establishing-the-blogs-to-cross-reference-my-entities-with-their-respective-tag-lists>4. Establishing the blogs to cross-reference my entities with their respective tag lists</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Blog list</span></span>
<span class=line><span style=color:#e1e4e8>blogs </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [</span><span style=color:#9ecbff>'sampleface.co.uk'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>	'cultrface.co.uk'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>	'logicface.co.uk'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>	'playrface.co.uk'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>	'distantarcade.co.uk'</span><span style=color:#e1e4e8>]</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Empty lists for existing tags and text from multiple URLs</span></span>
<span class=line><span style=color:#e1e4e8>existing_tags </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []</span></span>
<span class=line><span style=color:#e1e4e8>all_txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Upper limits for tag page range</span></span>
<span class=line><span style=color:#e1e4e8>upper_limits </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> {</span></span>
<span class=line><span style=color:#9ecbff>  'sampleface.co.uk'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>4</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>  'cultrface.co.uk'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>4</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>  'logicface.co.uk'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>  'playrface.co.uk'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>  'distantarcade.co.uk'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#9ecbff>  'ld89.org'</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>1</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span></code></pre><p>Here, we introduce the blogs for our content ideas generator using tags from my blogs. I made a list of all 5 blogs to choose, created empty lists to add existing tags and set upper limits for the tag page ranges.</p><p>The tag data comes from WordPress’s REST API which lists various elements of a WordPress blog such as tags, categories, posts, and media. For the tags, I can pull data at 100 tags per page but when I need to run the for-loop to pull what I need, I need to set an upper limit (eg. if I have 350 tags, the range would be from 0 to 4).</p><p>Also, I have to set this upper limit manually as I have no way of automating it (but if such a way exists, please let me know!)</p><h3 id=5-the-streamlit-ui-stuff>5. The Streamlit UI stuff</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Streamlit stuff</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>st.sidebar.title(</span><span style=color:#9ecbff>'Tag suggester'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>input_type </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.sidebar.radio(</span></span>
<span class=line><span style=color:#9ecbff>	'Select your input type'</span><span style=color:#e1e4e8>,</span></span>
<span class=line><span style=color:#e1e4e8>	[</span><span style=color:#9ecbff>'Text'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'URL'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'Multiple URLs'</span><span style=color:#e1e4e8>])</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>update_tags </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.sidebar.button(</span><span style=color:#9ecbff>'↻ Refresh tags'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>tag_ideas </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.sidebar.button(</span><span style=color:#9ecbff>'Load tag ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Determines input types</span></span>
<span class=line><span style=color:#e1e4e8>st.title(</span><span style=color:#9ecbff>'Welcome to RALTS (Really Awesome Lexicon and Tag Suggester)!'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>st.write(</span><span style=color:#9ecbff>'This script can analyse any body of text or URL to find extract keywords, topics, and categories using NLP (natural language processing).'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>if</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Text'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>  txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.text_area(</span><span style=color:#9ecbff>'Enter text to be analysed...'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>  txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> txt.replace(</span><span style=color:#9ecbff>'</span><span style=color:#79b8ff>\n</span><span style=color:#9ecbff>'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'"'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'“'</span><span style=color:#e1e4e8>,</span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'”'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'‘'</span><span style=color:#e1e4e8>,</span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'’'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>"'s"</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>","</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>  st.write(</span><span style=color:#79b8ff>len</span><span style=color:#e1e4e8>(txt))</span></span>
<span class=line><span style=color:#f97583>elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'URL'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>  url </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.text_input(</span><span style=color:#9ecbff>'Enter URL'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Multiple URLs'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>  multi_url </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.text_area(</span><span style=color:#9ecbff>'Enter keywords, 1 per line'</span><span style=color:#e1e4e8>)</span></span></code></pre><p>This displays all the inputs and radio buttons needed to pick the right functionality.</p><h3 id=6-functions-for-updating-my-tag-lists-via-wordpresss-rest-api>6. Functions for updating my tag lists via WordPress’s REST API</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> update_all_tags</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>  with</span><span style=color:#e1e4e8> st.spinner(</span><span style=color:#9ecbff>'Reloading tags...'</span><span style=color:#e1e4e8>):</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>    for</span><span style=color:#e1e4e8> blog </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> blogs:</span></span>
<span class=line><span style=color:#e1e4e8>    </span></span>
<span class=line><span style=color:#6a737d>      # Get tag data</span></span>
<span class=line><span style=color:#f97583>      for</span><span style=color:#e1e4e8> pg </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>, upper_limits[blog]</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>):</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>        tag_url </span><span style=color:#f97583>=</span><span style=color:#f97583> f</span><span style=color:#9ecbff>'https://</span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>blog</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>/wp-json/wp/v2/tags?per_page=100&#x26;page=</span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>pg</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>'</span></span>
<span class=line><span style=color:#e1e4e8>        r_tag </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> requests.get(tag_url)</span></span>
<span class=line><span style=color:#e1e4e8>        api_tags </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> r_tag.json()</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>        for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>,</span><span style=color:#79b8ff>len</span><span style=color:#e1e4e8>(api_tags)):</span></span>
<span class=line><span style=color:#e1e4e8>          tags[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>].append(api_tags[n][</span><span style=color:#9ecbff>'name'</span><span style=color:#e1e4e8>])</span></span>
<span class=line><span style=color:#e1e4e8>          tags[</span><span style=color:#9ecbff>'ID'</span><span style=color:#e1e4e8>].append(api_tags[n][</span><span style=color:#9ecbff>'id'</span><span style=color:#e1e4e8>])</span></span>
<span class=line><span style=color:#e1e4e8>          tags[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>].append(api_tags[n][</span><span style=color:#9ecbff>'count'</span><span style=color:#e1e4e8>])</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>        with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#f97583>f</span><span style=color:#9ecbff>"</span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>blog</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>.json"</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>"w"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> outfile:</span></span>
<span class=line><span style=color:#e1e4e8>          json.dump(tags, outfile)</span></span>
<span class=line><span style=color:#e1e4e8>      tags[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>] </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []</span></span>
<span class=line><span style=color:#e1e4e8>      tags[</span><span style=color:#9ecbff>'ID'</span><span style=color:#e1e4e8>] </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []</span></span>
<span class=line><span style=color:#e1e4e8>      tags[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>] </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> []</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>list_of_blogs </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.radio(</span><span style=color:#9ecbff>"Select the corresponding blog"</span><span style=color:#e1e4e8>, blogs)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d># Load JSON files</span></span>
<span class=line><span style=color:#f97583>with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#f97583>f</span><span style=color:#9ecbff>'</span><span style=color:#79b8ff>{</span><span style=color:#e1e4e8>list_of_blogs</span><span style=color:#79b8ff>}</span><span style=color:#9ecbff>.json'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'rb'</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> f:</span></span>
<span class=line><span style=color:#e1e4e8>  blog_json </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(f)</span></span>
<span class=line><span style=color:#e1e4e8>  x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> blog_json[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>  for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> x:</span></span>
<span class=line><span style=color:#e1e4e8>    existing_tags.append(n)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>submit </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> st.button(</span><span style=color:#9ecbff>'Submit'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>if</span><span style=color:#e1e4e8> update_tags:</span></span>
<span class=line><span style=color:#e1e4e8>  update_all_tags()</span></span></code></pre><p>There are two functions linked to the tag data. First is a function that pulls the tag name, tag ID, and how many posts have been assigned to that tag and adds them to a dictionary. This is then saved to a JSON file for offline use. Doing this avoids making multiple API calls since, theoretically, the tag data won’t change that frequently. But when it does change, you can refresh the JSON files. These were formerly pickle files but due to the poor security, I spent a few hours switching this code out. I still love pickles though.</p><p>From there, we can also read those files and add them to our existing_tags list ready for cross referencing against the extracted entities we find.</p><h3 id=7-the-random-functions-for-content-ideas>7. The random functions for content ideas</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Tag ideas functions</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> sf_words</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"sampleface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> sf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>		sf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(sf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>	sf_words_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> sf[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>	return</span><span style=color:#e1e4e8> sf_words_lists</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> cultr_words</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"cultrface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> cf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>		cf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(cf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>	cf_words_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> cf[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>	return</span><span style=color:#e1e4e8> cf_words_lists</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> logic_words</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"logicface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> lf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>		lf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(lf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>	lf_words_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> lf[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>	return</span><span style=color:#e1e4e8> lf_words_lists</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> playr_words</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"playrface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> pf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>		pf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(pf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>	pf_words_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pf[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>	return</span><span style=color:#e1e4e8> pf_words_lists</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> da_words</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"distantarcade.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> da_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>		da </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(da_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>	da_words_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> da[</span><span style=color:#9ecbff>'Tag'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>	return</span><span style=color:#e1e4e8> da_words_lists</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>all_words_list </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [sf_words(), cultr_words(), logic_words(), playr_words(), da_words()]</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> sampleface</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	st.header(</span><span style=color:#9ecbff>'Sampleface ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	for</span><span style=color:#e1e4e8> sample </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>		with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"sampleface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> sf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>			sf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(sf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>		sf_words_count_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> sf[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>		try</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>			x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [n</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>(n</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> sf_words_count_lists]</span></span>
<span class=line><span style=color:#f97583>		except</span><span style=color:#79b8ff> ZeroDivisionError</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>			continue</span></span>
<span class=line><span style=color:#6a737d>			# sf_choices = random.choices(sf_words_count_lists, weights=(1/n), k=2)</span></span>
<span class=line><span style=color:#e1e4e8>		sample </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> random.choices(sf_words(), x, </span><span style=color:#ffab70>k</span><span style=color:#f97583>=</span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#e1e4e8>		st.write(</span><span style=color:#9ecbff>'https://google.com/search?q='</span><span style=color:#f97583> +</span><span style=color:#9ecbff> '+'</span><span style=color:#e1e4e8>.join(sample).lower().replace(</span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'+'</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'&#x26;'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>))</span></span>
<span class=line><span style=color:#e1e4e8>	</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> cultrface</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	st.header(</span><span style=color:#9ecbff>'Cultrface ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	for</span><span style=color:#e1e4e8> sample </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>		with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"cultrface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> cf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>			cf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(cf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>		cf_words_count_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> cf[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>		try</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>			x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [n</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>(n</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> cf_words_count_lists]</span></span>
<span class=line><span style=color:#f97583>		except</span><span style=color:#79b8ff> ZeroDivisionError</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>			continue</span></span>
<span class=line><span style=color:#6a737d>			# sf_choices = random.choices(sf_words_count_lists, weights=(1/n), k=2)</span></span>
<span class=line><span style=color:#e1e4e8>		sample </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> random.choices(cultr_words(), x, </span><span style=color:#ffab70>k</span><span style=color:#f97583>=</span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#e1e4e8>		st.write(</span><span style=color:#9ecbff>'https://google.com/search?q='</span><span style=color:#f97583> +</span><span style=color:#9ecbff> '+'</span><span style=color:#e1e4e8>.join(sample).lower().replace(</span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'+'</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'&#x26;'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>))</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> logicface</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	st.header(</span><span style=color:#9ecbff>'LOGiCFACE ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	for</span><span style=color:#e1e4e8> sample </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>		with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"logicface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> lf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>			lf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(lf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>		lf_words_count_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> lf[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>		try</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>			x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [n</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>(n</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> lf_words_count_lists]</span></span>
<span class=line><span style=color:#f97583>		except</span><span style=color:#79b8ff> ZeroDivisionError</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>			continue</span></span>
<span class=line><span style=color:#e1e4e8>		sample </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> random.choices(logic_words(), x, </span><span style=color:#ffab70>k</span><span style=color:#f97583>=</span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#e1e4e8>		st.write(</span><span style=color:#9ecbff>'https://google.com/search?q='</span><span style=color:#f97583> +</span><span style=color:#9ecbff> '+'</span><span style=color:#e1e4e8>.join(sample).lower().replace(</span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'+'</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'&#x26;'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>))</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> playrface</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	st.header(</span><span style=color:#9ecbff>'Playrface ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	for</span><span style=color:#e1e4e8> sample </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>		with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"playrface.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> pf_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>			pf </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(pf_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>		pf_words_count_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pf[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>		try</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>			x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [n</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>(n</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> pf_words_count_lists]</span></span>
<span class=line><span style=color:#f97583>		except</span><span style=color:#79b8ff> ZeroDivisionError</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>			continue</span></span>
<span class=line><span style=color:#e1e4e8>		sample </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> random.choices(playr_words(), x, </span><span style=color:#ffab70>k</span><span style=color:#f97583>=</span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#e1e4e8>		st.write(</span><span style=color:#9ecbff>'https://google.com/search?q='</span><span style=color:#f97583> +</span><span style=color:#9ecbff> '+'</span><span style=color:#e1e4e8>.join(sample).lower().replace(</span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'+'</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'&#x26;'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>))</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> distantarcade</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	st.header(</span><span style=color:#9ecbff>'Distant Arcade ideas'</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	for</span><span style=color:#e1e4e8> sample </span><span style=color:#f97583>in</span><span style=color:#79b8ff> range</span><span style=color:#e1e4e8>(</span><span style=color:#79b8ff>5</span><span style=color:#e1e4e8>):</span></span>
<span class=line><span style=color:#f97583>		with</span><span style=color:#79b8ff> open</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>"distantarcade.co.uk.json"</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>as</span><span style=color:#e1e4e8> da_json_file:</span></span>
<span class=line><span style=color:#e1e4e8>			da </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> json.load(da_json_file)</span></span>
<span class=line><span style=color:#e1e4e8>		da_words_count_lists </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> da[</span><span style=color:#9ecbff>'Count'</span><span style=color:#e1e4e8>]</span></span>
<span class=line><span style=color:#f97583>		try</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>			x </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [n</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>(n</span><span style=color:#f97583>+</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> n </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> da_words_count_lists]</span></span>
<span class=line><span style=color:#f97583>		except</span><span style=color:#79b8ff> ZeroDivisionError</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>			continue</span></span>
<span class=line><span style=color:#e1e4e8>		sample </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> random.choices(da_words(), x, </span><span style=color:#ffab70>k</span><span style=color:#f97583>=</span><span style=color:#79b8ff>2</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#e1e4e8>		st.write(</span><span style=color:#9ecbff>'https://google.com/search?q='</span><span style=color:#f97583> +</span><span style=color:#9ecbff> '+'</span><span style=color:#e1e4e8>.join(sample).lower().replace(</span><span style=color:#9ecbff>' '</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'+'</span><span style=color:#e1e4e8>).replace(</span><span style=color:#9ecbff>'&#x26;'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8>))</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> all_blogs</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>	sampleface()</span></span>
<span class=line><span style=color:#e1e4e8>	cultrface()</span></span>
<span class=line><span style=color:#e1e4e8>	logicface()</span></span>
<span class=line><span style=color:#e1e4e8>	playrface()</span></span>
<span class=line><span style=color:#e1e4e8>	distantarcade()</span></span></code></pre><p>I’ll try to summarise this part as it is quite lengthy. Each JSON file is read and the relevant list is pulled containing all the respective blogs’ tags. To generate the Google Search URLs, a for-loop picks out the tags’ counts and generates a new list which can be used for weighting in the random.choices method. Then a series of 2-3 tags are chosen at random, weighted by least used tag = most likely chosen and appended to the Google Search URL.</p><p>Finally, they’re all grouped together in a main function ready to be called at the click of a button.</p><h3 id=8-the-entity-topic-and-category-functions-using-the-textrazor-api>8. The entity, topic, and category functions using the TextRazor API</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Keyword extraction function to analyse with TextRazor</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> textrazor_extraction</span><span style=color:#e1e4e8>(input_type):</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	if</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Text'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#f97583>		global</span><span style=color:#e1e4e8> txt</span></span>
<span class=line><span style=color:#e1e4e8>		response </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> client.analyze(txt)</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> entity </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.entities():</span></span>
<span class=line><span style=color:#f97583>			if</span><span style=color:#e1e4e8> entity.relevance_score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>				ent_dict[</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>].append(entity.id)</span></span>
<span class=line><span style=color:#e1e4e8>				ent_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(entity.relevance_score)</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> entity.id.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> entity.id.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>				else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> topic </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.topics():</span></span>
<span class=line><span style=color:#f97583>			if</span><span style=color:#e1e4e8> topic.score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0.6</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>				topics_dict[</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>].append(topic.label)</span></span>
<span class=line><span style=color:#e1e4e8>				topics_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(topic.score)</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> topic.label.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> topic.label.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>				else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> category </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.categories():</span></span>
<span class=line><span style=color:#e1e4e8>			categories_dict[</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>].append(category.label)</span></span>
<span class=line><span style=color:#e1e4e8>			categories_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(category.score)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'URL'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>		txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> req(url)</span></span>
<span class=line><span style=color:#e1e4e8>		response </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> client.analyze(txt)</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> entity </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.entities():</span></span>
<span class=line><span style=color:#f97583>			if</span><span style=color:#e1e4e8> entity.relevance_score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>				ent_dict[</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>].append(entity.id)</span></span>
<span class=line><span style=color:#e1e4e8>				ent_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(entity.relevance_score)</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> entity.id.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> entity.id.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>				else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> topic </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.topics():</span></span>
<span class=line><span style=color:#f97583>			if</span><span style=color:#e1e4e8> topic.score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0.6</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>				topics_dict[</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>].append(topic.label)</span></span>
<span class=line><span style=color:#e1e4e8>				topics_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(topic.score)</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> topic.label.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> topic.label.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>				else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		</span></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> category </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.categories():</span></span>
<span class=line><span style=color:#e1e4e8>			categories_dict[</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>].append(category.label)</span></span>
<span class=line><span style=color:#e1e4e8>			categories_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(category.score)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Multiple URLs'</span><span style=color:#e1e4e8>:</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>		for</span><span style=color:#e1e4e8> u </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> urls:</span></span>
<span class=line><span style=color:#e1e4e8>			txt </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> req(u)</span></span>
<span class=line><span style=color:#e1e4e8>			all_txt.append(txt)</span></span>
<span class=line><span style=color:#e1e4e8>			response </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> client.analyze(txt)</span></span>
<span class=line><span style=color:#f97583>			for</span><span style=color:#e1e4e8> entity </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.entities():</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> entity.relevance_score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>].append(entity.id)</span></span>
<span class=line><span style=color:#e1e4e8>					ent_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(entity.relevance_score)</span></span>
<span class=line><span style=color:#f97583>					if</span><span style=color:#e1e4e8> entity.id.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> entity.id.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>						ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>					else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>						ent_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>			</span></span>
<span class=line><span style=color:#f97583>			for</span><span style=color:#e1e4e8> topic </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.topics():</span></span>
<span class=line><span style=color:#f97583>				if</span><span style=color:#e1e4e8> topic.score </span><span style=color:#f97583>></span><span style=color:#79b8ff> 0.6</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>].append(topic.label)</span></span>
<span class=line><span style=color:#e1e4e8>					topics_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(topic.score)</span></span>
<span class=line><span style=color:#f97583>					if</span><span style=color:#e1e4e8> topic.label.lower() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags </span><span style=color:#f97583>or</span><span style=color:#e1e4e8> topic.label.capitalize() </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> existing_tags:</span></span>
<span class=line><span style=color:#e1e4e8>						topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>1</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#f97583>					else</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>						topics_dict[</span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>].append(</span><span style=color:#79b8ff>0</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>			</span></span>
<span class=line><span style=color:#f97583>			for</span><span style=color:#e1e4e8> category </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> response.categories():</span></span>
<span class=line><span style=color:#e1e4e8>				categories_dict[</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>].append(category.label)</span></span>
<span class=line><span style=color:#e1e4e8>				categories_dict[</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>].append(category.score)</span></span></code></pre><p>Depending on the input (text, URL, or multiple URLs), this function analyses the text, finds the topics, entities, and categories and adds them to a dictionary. I set a threshold for the relevance score to ignore anything that had a score of 0. I also added a check for matching tags, so if an entity is already in my tag list, it’ll give me a 1 or 0 if not. It’s worth noting that this is inconsistent despite my best efforts so if you see the code and can tell me how to do this better, let me know!</p><h3 id=9-the-function-for-displaying-that-data-in-dataframe-form>9. The function for displaying that data in DataFrame form</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># DataFrames to present above data</span></span>
<span class=line><span style=color:#f97583>def</span><span style=color:#b392f0> data_viz</span><span style=color:#e1e4e8>():</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	if</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Text'</span><span style=color:#e1e4e8>:</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d>		# df_kw = pd.DataFrame(kw_dict)</span></span>
<span class=line><span style=color:#6a737d>		# # grouped_df_kw = df_kw.groupby(['Keyword']).agg({'Relevance Score': ['mean'], 'Existing Tag': ['max']}).round(3)</span></span>
<span class=line><span style=color:#6a737d>		# # grouped_df_kw = grouped_df_kw.reset_index()</span></span>
<span class=line><span style=color:#6a737d>		# st.header('Keywords')</span></span>
<span class=line><span style=color:#6a737d>		# st.dataframe(df_kw)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(ent_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_ent.groupby([</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>], </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'max'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_ent.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Entities'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_ent)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(topics_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_topic.groupby([</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>], </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'max'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_topic.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Topics'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_topic)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(categories_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_cat.groupby([</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_cat.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Categories'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_cat)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'URL'</span><span style=color:#e1e4e8>:</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(ent_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_ent.groupby([</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>], </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'max'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_ent.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Entities'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_ent)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(topics_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_topic.groupby([</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>], </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'max'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_topic.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Topics'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_topic)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(categories_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_cat.groupby([</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>]).agg({</span><span style=color:#9ecbff>'Relevance Score'</span><span style=color:#e1e4e8>: [</span><span style=color:#9ecbff>'mean'</span><span style=color:#e1e4e8>]}).round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_cat.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Categories'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_cat)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>	elif</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Multiple URLs'</span><span style=color:#e1e4e8>:</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(ent_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_ent.groupby([</span><span style=color:#9ecbff>'Keyword'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>]).describe().round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_ent </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_ent.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Entities'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_ent)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(topics_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_topic.groupby([</span><span style=color:#9ecbff>'Topic'</span><span style=color:#e1e4e8>, </span><span style=color:#9ecbff>'Existing Tag'</span><span style=color:#e1e4e8>]).describe().round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_topic </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_topic.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Topics'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_topic)</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>		df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> pd.DataFrame(categories_dict)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> df_cat.groupby(</span><span style=color:#9ecbff>'Category'</span><span style=color:#e1e4e8>).describe().round(</span><span style=color:#79b8ff>3</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		grouped_df_cat </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> grouped_df_cat.reset_index()</span></span>
<span class=line><span style=color:#e1e4e8>		st.header(</span><span style=color:#9ecbff>'Categories'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>		st.dataframe(grouped_df_cat)</span></span></code></pre><p>The penultimate function converts those dictionaries into dataframes. The data is aggregated by relevance score (if multiple instances of an entity are found, I get the mean relevance score), and the max value of existing tags (1 or 0). For multiple URLs, I’ve used describe() to give me a full range of statistical data. Most of it is superfluous but it was the best thing I could find to get the data I needed.</p><p>Below is a table of the top 5 entities found in this blog post, ordered by relevance score:</p><table><thead><tr><th>Keyword</th><th>Relevance Score</th><th>Existing tag</th></tr></thead><tbody><tr><td>Website</td><td>0.6620</td><td>0</td></tr><tr><td>Search engine optimization</td><td>0.6460</td><td>0</td></tr><tr><td>Web scraping</td><td>0.6450</td><td>0</td></tr><tr><td>World Wide Website</td><td>0.6440</td><td>0</td></tr><tr><td>HTML</td><td>0.6320</td><td>0</td></tr></tbody></table><p>A table of the top 5 topics found in this blog post, ordered by relevance score:</p><table><thead><tr><th>Topic</th><th>Relevance Score</th><th>Existing tag</th></tr></thead><tbody><tr><td>API</td><td>1.0000</td><td>0</td></tr><tr><td>Blog</td><td>1.0000</td><td>0</td></tr><tr><td>Computer science</td><td>1.0000</td><td>1</td></tr><tr><td>Computing</td><td>1.0000</td><td>0</td></tr><tr><td>Google Search</td><td>1.0000</td><td>0</td></tr></tbody></table><p>And a table of the top 5 categories found in this blog post, ordered by relevance score:</p><table><thead><tr><th>Category</th><th>Relevance Score</th></tr></thead><tbody><tr><td>economy, business and finance>computing and information technology</td><td>0.8100</td></tr><tr><td>economy, business and finance>computing and information technology>software</td><td>0.7330</td></tr><tr><td>arts, culture and entertainment>internet</td><td>0.6020</td></tr><tr><td>arts, culture and entertainment>language</td><td>0.5620</td></tr><tr><td>science and technology>engineering</td><td>0.5360</td></tr></tbody></table><h3 id=10-execution-of-the-all-the-functions-to-make-it-work>10. Execution of the all the functions to make it work</h3><pre class="astro-code github-dark" data-language=python style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># Execute functions</span></span>
<span class=line><span style=color:#f97583>if</span><span style=color:#e1e4e8> tag_ideas:</span></span>
<span class=line><span style=color:#e1e4e8>	all_blogs()</span></span>
<span class=line><span style=color:#f97583>elif</span><span style=color:#e1e4e8> submit </span><span style=color:#f97583>and</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>and</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Text'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>	textrazor_extraction(</span><span style=color:#9ecbff>'Text'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>	data_viz()</span></span>
<span class=line><span style=color:#e1e4e8>	main()</span></span>
<span class=line><span style=color:#f97583>elif</span><span style=color:#e1e4e8> submit </span><span style=color:#f97583>and</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'URL'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>	textrazor_extraction(</span><span style=color:#9ecbff>'URL'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>	data_viz()</span></span>
<span class=line><span style=color:#e1e4e8>	main()</span></span>
<span class=line><span style=color:#f97583>elif</span><span style=color:#e1e4e8> submit </span><span style=color:#f97583>and</span><span style=color:#e1e4e8> input_type </span><span style=color:#f97583>==</span><span style=color:#9ecbff> 'Multiple URLs'</span><span style=color:#e1e4e8>:</span></span>
<span class=line><span style=color:#e1e4e8>	urls </span><span style=color:#f97583>=</span><span style=color:#e1e4e8> [line </span><span style=color:#f97583>for</span><span style=color:#e1e4e8> line </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> multi_url.split(</span><span style=color:#9ecbff>"</span><span style=color:#79b8ff>\n</span><span style=color:#9ecbff>"</span><span style=color:#e1e4e8>)]</span></span>
<span class=line><span style=color:#e1e4e8>	textrazor_extraction(</span><span style=color:#9ecbff>'Multiple URLs'</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#e1e4e8>	data_viz()</span></span></code></pre><p>Finally, we have all the functions ready to call, depending on whether I’m analysing raw text or URLs.</p><h2 id=who_could_this_benefit>Who could this benefit?</h2><p>As I said earlier, I’ve made this mainly for myself and as a way to improve my taxonomies. I made a pledge to write about more Black content and scripts like this keep me in check as I can fill in gaps where content is lacking. It also inspires me to learn new things I never would have found from plain searching or from the blogs I follow (<a href=/posts/this-is-my-content-creation-flow/ >also part of my process which I wrote about a few years ago</a>).</p><p>But this kind of script is for any of the following types of people:</p><ul><li>To analyse text for entity relevance</li><li>To find internal linking opportunities, particularly those interested in using LOD (linked open data)</li><li>Content ideas</li><li>To check if your text is aligned how you want it</li></ul><h2 id=evaluation>Evaluation</h2><p>This Python script is not perfect. It’s rough around the edges and works for my specific use case so for anyone else, they would need to tweak it or potentially rewrite it for their own needs.</p><p>One significant change that could be made is with the use of the BART model. This isn’t fine-tuned in anyway so its classification could be improved if you trained the model on specific datasets.</p><p>There are also no means of downloading the outputted data. This is a personal preference as I tend to read off the screen and move on but for other use cases, you may want the CSVs. That can be added in.</p><h2 id=summary>Summary</h2><p>I hope this has been insightful for anyone reading. While I’ve been learning Python and it makes sense to me, I appreciate it can feel daunting to take this in without the same knowledge. I rarely have to explain my personal projects and don’t like to say “hey, I made this thing” because who cares (that’s what I say in my head anyway). At the very least, I can say I did a thing and explained why and it will benefit me.</p><div class=filed-under data-astro-cid-4diiyzd3><span class=filed-under__intro data-astro-cid-4diiyzd3>Filed under:</span> <span data-astro-cid-4diiyzd3><a href=/jardim/tech/ai/ data-astro-cid-4diiyzd3>AI</a> | </span><span data-astro-cid-4diiyzd3><a href=/jardim/tech/python/ data-astro-cid-4diiyzd3>Python</a> | </span><span data-astro-cid-4diiyzd3><a href=/jardim/tech/seo/ data-astro-cid-4diiyzd3>SEO</a></span></div><div class=post-pagination><a href=/posts/keep-writing-anyway/ class="post-pagination-item post-pagination-prev">Keep writing anyway</a> <a href=/posts/third-year-professional-seo/ class="post-pagination-item post-pagination-next">12 Things I Learnt In My 3rd Year As A Professional SEO</a></div></div></article></main><footer data-astro-cid-sz7xmlte><nav class=footer-nav-links data-astro-cid-sz7xmlte><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte class=footer-url>lukealexdavis.co.uk</li><li data-astro-cid-sz7xmlte>Copyright 2026 © Luke Davis</li><li data-astro-cid-sz7xmlte class=clock></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=#top data-astro-cid-sz7xmlte>&ShortUpArrow; Back to top</a> | <a href=/ data-astro-cid-sz7xmlte>👠👠</a> (just click the heels once to go home)</li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=/release-notes/ data-astro-cid-sz7xmlte>Release Notes</a> | <a href=/morsels/ data-astro-cid-sz7xmlte>Morsels</a> | <a href=/lists/ data-astro-cid-sz7xmlte>Lists</a> | <a href=/recortes/ data-astro-cid-sz7xmlte>Recortes</a> | <a href=/linkblog/ data-astro-cid-sz7xmlte>Linkblog</a> | <a href=/linktree/ data-astro-cid-sz7xmlte>Linktree</a> | <a href=/webrings/ data-astro-cid-sz7xmlte>Webrings</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=/fave-tweets/ data-astro-cid-sz7xmlte>Fave Tweets</a> | <a href=/important-albums/ data-astro-cid-sz7xmlte>Important Albums</a> | <a href=/letterboxd-diaries/ data-astro-cid-sz7xmlte>Letterboxd Diaries</a> | <a href=/gameslist/ data-astro-cid-sz7xmlte>Gameslist</a> | <a href=/blogroll/ data-astro-cid-sz7xmlte>Blogroll</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=/ai/ data-astro-cid-sz7xmlte>AI (and how I use it)</a> | <a href=/humans.txt data-astro-cid-sz7xmlte>humans.txt</a> | <a href=/rules.txt data-astro-cid-sz7xmlte>rules.txt</a> | 🇵🇸 <a href=/jardim/palestine/ data-astro-cid-sz7xmlte>Free Palestine!</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=/omnifeed.xml data-astro-cid-sz7xmlte style=color:#ff5704>RSS feed</a> | <a href=/html-sitemap/ data-astro-cid-sz7xmlte>HTML Sitemap</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=https://webring.xxiivv.com/lukealexdavis data-astro-cid-sz7xmlte target=_blank rel=noopener><img alt="XXIIVV webring" src=https://webring.xxiivv.com/icon.white.svg data-astro-cid-sz7xmlte height=20 loading=lazy width=20></a></li></ul></nav><div class=colophon data-astro-cid-sz7xmlte><ul data-astro-cid-sz7xmlte></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte><a href=https://astro.build/ data-astro-cid-sz7xmlte>Built with Astro</a>, HTML, CSS, and a <span data-astro-cid-sz7xmlte lang=fr>soupçon</span> of JS.</li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte>Member: <a href=https://250kb.club/ data-astro-cid-sz7xmlte>250KB Club</a> | <a href=https://512kb.club/ data-astro-cid-sz7xmlte>512KB Club</a> | <a href=https://1mb.club/ data-astro-cid-sz7xmlte>1MB Club</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte>Listed @ <a href=https://linklane.net data-astro-cid-sz7xmlte target=_blank>LinkLane.Net</a></li></ul><ul data-astro-cid-sz7xmlte><li data-astro-cid-sz7xmlte style=font-family:Georgia,serif;font-style:italic>And I'm not only a member of the Hair Club for Men<br data-astro-cid-sz7xmlte>&mdash;I'm also the president.</li></ul><a href=https://github.com/uxai/non-profit-bloggers/ data-astro-cid-sz7xmlte><div style="margin:1rem 0"><svg height=20 viewBox="0 0 118 20" width=118 xmlns=http://www.w3.org/2000/svg fill=none><title>Non-Profit Blogger</title><desc>A lilac badge with the words "Non-Profit Bloggers" in the middle.</desc><rect height=19 rx=2.5 width=117 x=0.5 y=0.5 fill=url(#paint0_linear_55_5)></rect><rect height=19 rx=2.5 width=117 x=0.5 y=0.5 fill=url(#paint1_linear_55_5)></rect><path d="M7.91662 6.25002C7.27683 6.25002 6.63396 6.45833 6.14579 6.95833C5.1695 7.95833 5.19629 9.49999 6.14579 10.5L9.99996 14.5833L13.8541 10.5C14.8037 9.49999 14.8304 7.95833 13.8541 6.95833C12.8779 5.99999 11.2887 5.99999 10.3125 6.95833L9.99996 7.29168L9.68746 6.95833C9.19912 6.45833 8.55642 6.25002 7.91662 6.25002Z" fill=#492E76></path><path d="M19.6875 6.8125H21.0625V8.875H21.75V9.5625H22.4375V6.8125H23.8125V13H22.4375V10.9375H21.75V10.25H21.0625V13H19.6875V6.8125ZM25.875 6.8125H28.625V7.5H29.3125V12.3125H28.625V13H25.875V12.3125H25.1875V7.5H25.875V6.8125ZM27.9375 7.5H26.5625V12.3125H27.9375V7.5ZM30.6875 6.8125H32.0625V8.875H32.75V9.5625H33.4375V6.8125H34.8125V13H33.4375V10.9375H32.75V10.25H32.0625V13H30.6875V6.8125ZM36.1875 9.5625H38.9375V10.25H36.1875V9.5625ZM40.3125 6.8125H43.75V7.5H44.4375V9.5625H43.75V10.25H41.6875V13H40.3125V6.8125ZM43.0625 7.5H41.6875V9.5625H43.0625V7.5ZM48.5625 7.5H47.1875V9.5625H48.5625V7.5ZM45.8125 6.8125H49.25V7.5H49.9375V9.5625H49.25V10.25H48.5625V10.9375H49.25V11.625H49.9375V13H48.5625V11.625H47.875V10.9375H47.1875V13H45.8125V6.8125ZM52 6.8125H54.75V7.5H55.4375V12.3125H54.75V13H52V12.3125H51.3125V7.5H52V6.8125ZM54.0625 7.5H52.6875V12.3125H54.0625V7.5ZM56.8125 6.8125H60.9375V7.5H58.1875V9.5625H59.5625V10.25H58.1875V13H56.8125V6.8125ZM63 6.8125H64.375V13H63V6.8125ZM66.4375 6.8125H70.5625V7.5H69.1875V13H67.8125V7.5H66.4375V6.8125ZM74.6875 6.8125H78.125V7.5H78.8125V9.5625H78.125V10.25H78.8125V12.3125H78.125V13H74.6875V6.8125ZM77.4375 7.5H76.0625V9.5625H77.4375V7.5ZM77.4375 10.25H76.0625V12.3125H77.4375V10.25ZM80.1875 6.8125H81.5625V12.3125H84.3125V13H80.1875V6.8125ZM86.375 6.8125H89.125V7.5H89.8125V12.3125H89.125V13H86.375V12.3125H85.6875V7.5H86.375V6.8125ZM88.4375 7.5H87.0625V12.3125H88.4375V7.5ZM91.875 6.8125H94.625V7.5H95.3125V8.1875H93.9375V7.5H92.5625V12.3125H93.9375V10.25H93.25V9.5625H95.3125V13H91.875V12.3125H91.1875V7.5H91.875V6.8125ZM97.375 6.8125H100.125V7.5H100.812V8.1875H99.4375V7.5H98.0625V12.3125H99.4375V10.25H98.75V9.5625H100.812V13H97.375V12.3125H96.6875V7.5H97.375V6.8125ZM102.188 6.8125H106.312V7.5H103.562V9.5625H104.938V10.25H103.562V12.3125H106.312V13H102.188V6.8125ZM110.438 7.5H109.062V9.5625H110.438V7.5ZM107.688 6.8125H111.125V7.5H111.812V9.5625H111.125V10.25H110.438V10.9375H111.125V11.625H111.812V13H110.438V11.625H109.75V10.9375H109.062V13H107.688V6.8125Z" fill=#492E76></path><rect height=19 rx=2.5 width=117 x=0.5 y=0.5 stroke=#9D9CD3></rect><defs><linearGradient gradientUnits=userSpaceOnUse id=paint0_linear_55_5 x1=1 x2=117.69 y1=1 y2=10.6591><stop offset=0.1 stop-color=#BEBDFF></stop><stop offset=1 stop-color=#D1ADFF></stop></linearGradient><linearGradient gradientUnits=userSpaceOnUse id=paint1_linear_55_5 x1=59 x2=59 y1=1 y2=1.5><stop offset=0.9999 stop-color=white></stop><stop offset=1 stop-color=white stop-opacity=0></stop></linearGradient></defs></svg></div></a></div><script type=module>function e(){let t=new Date,e=t.getHours(),n=t.getMinutes(),r=t.getSeconds(),o=`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;document.querySelector(".clock").innerText=o}e(),setInterval(e,1e3)</script></footer></body></html>